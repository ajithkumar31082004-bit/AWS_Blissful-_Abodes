{% extends "layout.html" %}

{% block title %}Senior Staff Dashboard - {{ branch.branch_name }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboards.css') }}">
<style>
    .inventory-status {
        display: flex;
        justify-content: space-between;
        padding: 10px 0;
        border-bottom: 1px solid #eee;
    }
    .low-stock { color: var(--danger); font-weight: 700; }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-page">
    <div class="dashboard-hero">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1>Senior Staff Dashboard</h1>
                    <p>üè¢ {{ branch.branch_name }} | Operations & Staff Supervision</p>
                </div>
                <div class="role-badge role-manager" style="background: #28a745; color: white;">
                    <i class="fas fa-user-tie"></i> LEVEL 3 SENIOR STAFF
                </div>
            </div>
        </div>
    </div>

    <div class="dashboard-content container">
        <div class="stats-grid">
            <div class="glass-card stat-item">
                <div class="stat-icon"><i class="fas fa-users"></i></div>
                <div class="stat-value">15/18</div>
                <div class="stat-label">Staff on Duty</div>
            </div>
            <div class="glass-card stat-item">
                <div class="stat-icon"><i class="fas fa-tasks"></i></div>
                <div class="stat-value">7</div>
                <div class="stat-label">Pending Tasks</div>
            </div>
            <div class="glass-card stat-item">
                <div class="stat-icon"><i class="fas fa-smile"></i></div>
                <div class="stat-value">4.6</div>
                <div class="stat-label">Guest Satisfaction</div>
            </div>
            <div class="glass-card stat-item">
                <div class="stat-icon"><i class="fas fa-door-open"></i></div>
                <div class="stat-value">{{ branch_bookings|selectattr('check_in', 'equalto', today_iso)|list|length if today_iso else 12 }}</div>
                <div class="stat-label">Expected Check-ins</div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-9">
                <!-- Staff Management -->
                <div class="dashboard-section fade-in">
                    <div class="section-header">
                        <h2 class="section-title">Team Management & Shifts</h2>
                        <div class="action-buttons">
                            <button class="btn-primary btn-small">ASSIGN SHIFT</button>
                            <button class="btn-secondary btn-small">ATTENDANCE LOG</button>
                        </div>
                    </div>
                    <div class="glass-card">
                        <table class="premium-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Role</th>
                                    <th>Shift</th>
                                    <th>Status</th>
                                    <th>Performance</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Raj Kumar</strong></td>
                                    <td>Housekeeping</td>
                                    <td>Morning (6AM - 2PM)</td>
                                    <td><span class="status-pill status-available">ON DUTY</span></td>
                                    <td>95% rating</td>
                                </tr>
                                <tr>
                                    <td><strong>Priya Sharma</strong></td>
                                    <td>Front Desk</td>
                                    <td>Morning (6AM - 2PM)</td>
                                    <td><span class="status-pill status-available">ON DUTY</span></td>
                                    <td>92% rating</td>
                                </tr>
                                <tr>
                                    <td><strong>Arun Singh</strong></td>
                                    <td>Maintenance</td>
                                    <td>Evening (2PM - 10PM)</td>
                                    <td><span class="status-pill status-cleaning">OUTFITTING</span></td>
                                    <td>88% rating</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Housekeeping Tasks -->
                <div class="dashboard-section fade-in">
                    <div class="section-header">
                        <h2 class="section-title">Operation Tasks</h2>
                    </div>
                    <div class="glass-card">
                        <table class="premium-table">
                            <thead>
                                <tr>
                                    <th>Task</th>
                                    <th>Room/Area</th>
                                    <th>Priority</th>
                                    <th>Assigned To</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Full Deep Clean</td>
                                    <td>Room 205 (Suite)</td>
                                    <td><span class="badge badge-danger">HIGH</span></td>
                                    <td>Raj Kumar</td>
                                    <td><button class="btn-text">View</button></td>
                                </tr>
                                <tr>
                                    <td>AC Maintenance</td>
                                    <td>Room 102</td>
                                    <td><span class="badge badge-warning">MEDIUM</span></td>
                                    <td>Arun Singh</td>
                                    <td><button class="btn-text">View</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="col-md-3">
                <!-- Inventory Alerts -->
                <div class="glass-card mb-4">
                    <h3>Inventory Alert</h3>
                    <div class="mt-3">
                        <div class="inventory-status">
                            <span>Towels</span>
                            <span class="low-stock">45/50 (Low)</span>
                        </div>
                        <div class="inventory-status">
                            <span>Toiletries</span>
                            <span class="text-success">120/80 (OK)</span>
                        </div>
                        <div class="inventory-status">
                            <span>Bed Linens</span>
                            <span class="text-success">85/60 (OK)</span>
                        </div>
                    </div>
                    <button class="btn-primary btn-block mt-3">ORDER SUPPLIES</button>
                </div>

                <!-- Guest Feedback Monitor -->
                <div class="glass-card">
                    <h3>Recent Feedback</h3>
                    <div class="p-3 mb-2 rounded border">
                        <div class="d-flex justify-content-between mb-1">
                            <strong>Room 304</strong>
                            <small class="text-danger">NEGATIVE</small>
                        </div>
                        <p class="small mb-0">"AC was making noise during the night."</p>
                        <button class="btn-small btn-primary mt-2" style="font-size: 0.7rem;">RESOLVE</button>
                    </div>
                    <a href="#" class="btn-text">Monitor All Feedback</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
