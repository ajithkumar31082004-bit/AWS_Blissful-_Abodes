{% extends "layout.html" %}

{% block title %}Staff Dashboard - {{ user.branch_id }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboards.css') }}">
<style>
    .room-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 15px;
    }
    .room-box {
        aspect-ratio: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        border-radius: 12px;
        cursor: pointer;
        transition: transform 0.2s;
        border: 2px solid transparent;
    }
    .room-box:hover { transform: scale(1.05); }
    .room-box.available { background: #dcfce7; color: #166534; border-color: #86efac; }
    .room-box.occupied { background: #fee2e2; color: #991b1b; border-color: #fecaca; }
    .room-box.cleaning { background: #fef9c3; color: #854d0e; border-color: #fde047; }
    .room-box.maintenance { background: #dbeafe; color: #1e40af; border-color: #bfdbfe; }
    
    .floor-label {
        font-weight: 800;
        margin-top: 30px;
        margin-bottom: 15px;
        padding-bottom: 5px;
        border-bottom: 2px solid #ddd;
        color: #444;
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-page">
    <div class="dashboard-hero" style="background: var(--accent-gradient);">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1>{{ user.branch_id }} Operations</h1>
                    <p>Shift: <strong>Morning (6 AM - 2 PM)</strong> | Hello, {{ user.name }}!</p>
                </div>
                <div class="role-badge role-staff">
                    <i class="fas fa-user"></i> FRONT DESK STAFF
                </div>
            </div>
        </div>
    </div>

    <div class="dashboard-content container">
        <div class="stats-grid">
            <div class="glass-card stat-item">
                <div class="stat-icon" style="background: var(--primary-gradient);"><i class="fas fa-sign-in-alt"></i></div>
                <div class="stat-value">{{ today_check_ins|length if today_check_ins else 12 }}</div>
                <div class="stat-label">Check-ins Today</div>
            </div>
            <div class="glass-card stat-item">
                <div class="stat-icon" style="background: var(--secondary-gradient);"><i class="fas fa-sign-out-alt"></i></div>
                <div class="stat-value">{{ today_check_outs|length if today_check_outs else 8 }}</div>
                <div class="stat-label">Check-outs Today</div>
            </div>
            <div class="glass-card stat-item">
                <div class="stat-icon" style="background: var(--accent-gradient);"><i class="fas fa-bed"></i></div>
                <div class="stat-value">67/100</div>
                <div class="stat-label">Occupied Rooms</div>
            </div>
            <div class="glass-card stat-item">
                <div class="stat-icon" style="background: var(--primary-gradient);"><i class="fas fa-exclamation-circle"></i></div>
                <div class="stat-value">5</div>
                <div class="stat-label">Pending Tasks</div>
            </div>
        </div>

        <!-- Room Status Grid -->
        <div class="dashboard-section fade-in">
            <div class="section-header">
                <h2 class="section-title">Live Room Status Grid</h2>
                <div class="d-flex gap-3">
                    <div class="d-flex align-items-center gap-1 small"><div style="width:12px; height:12px; background:#dcfce7; border-radius:2px;"></div> Available</div>
                    <div class="d-flex align-items-center gap-1 small"><div style="width:12px; height:12px; background:#fee2e2; border-radius:2px;"></div> Occupied</div>
                    <div class="d-flex align-items-center gap-1 small"><div style="width:12px; height:12px; background:#fef9c3; border-radius:2px;"></div> Cleaning</div>
                </div>
            </div>
            <div class="glass-card">
                <div class="floor-label">Floor 1</div>
                <div class="room-grid">
                    {% for i in range(101, 111) %}
                    <div class="room-box {{ 'occupied' if i % 3 == 0 else 'cleaning' if i % 5 == 0 else 'available' }}">
                        <strong style="font-size: 1.2rem;">{{ i }}</strong>
                        <small style="font-size: 0.6rem;">{{ 'OCCUPIED' if i % 3 == 0 else 'CLEANING' if i % 5 == 0 else 'READY' }}</small>
                    </div>
                    {% endfor %}
                </div>

                <div class="floor-label">Floor 2</div>
                <div class="room-grid">
                    {% for i in range(201, 211) %}
                    <div class="room-box {{ 'occupied' if i % 4 == 0 else 'available' }}">
                        <strong style="font-size: 1.2rem;">{{ i }}</strong>
                        <small style="font-size: 0.6rem;">{{ 'OCCUPIED' if i % 4 == 0 else 'READY' }}</small>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <!-- Check-ins -->
                <div class="dashboard-section fade-in">
                    <div class="section-header">
                        <h2 class="section-title">Today's Check-ins</h2>
                        <button class="btn-primary btn-small">WALK-IN BOOKING</button>
                    </div>
                    <div class="glass-card">
                        <table class="premium-table">
                            <tbody>
                                <tr>
                                    <td><strong>Rahul Khanna</strong><br><small>Room 105 (Platinum)</small></td>
                                    <td>11:00 AM</td>
                                    <td><button class="btn-primary btn-small">CHECK IN</button></td>
                                </tr>
                                <tr>
                                    <td><strong>Amit Shah</strong><br><small>Room 201 (VIP)</small></td>
                                    <td>12:30 PM</td>
                                    <td><button class="btn-primary btn-small">CHECK IN</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <!-- Housekeeping Tasks -->
                <div class="dashboard-section fade-in">
                    <div class="section-header">
                        <h2 class="section-title">Housekeeping Status</h2>
                    </div>
                    <div class="glass-card">
                        <table class="premium-table">
                            <tbody>
                                <tr>
                                    <td><strong>Room 108</strong><br><small>Pending cleaning</small></td>
                                    <td><span class="status-pill status-cleaning">IN PROGRESS</span></td>
                                    <td><button class="btn-text">Log</button></td>
                                </tr>
                                <tr>
                                    <td><strong>Room 110</strong><br><small>Guest departed</small></td>
                                    <td><span class="status-pill status-occupied">DIRTY</span></td>
                                    <td><button class="btn-primary btn-small">ASSIGN</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
